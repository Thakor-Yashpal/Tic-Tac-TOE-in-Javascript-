"use strict";function sumArray(e){var t=0,r=0;for(r=0;r<e.length;r++)t+=e[r];return t}function isInArray(e,t){return-1<t.indexOf(e)}function shuffleArray(e){for(var t,r,n=e.length;0<n;)r=Math.floor(Math.random()*n),t=e[--n],e[n]=e[r],e[r]=t;return e}function intRandom(e,t){var r=e+Math.random()*(t+1-e);return Math.floor(r)}document.onkeypress=function(e){e=e||window.event;var t=document.getElementsByClassName("modal")[0];27===e.keyCode&&(t.style.display="none")},window.onclick=function(e){var t=document.getElementsByClassName("modal")[0];e.target===t&&(t.style.display="none")};var moves=0,winner=0,x=1,o=3,player=x,computer=o,whoseTurn=x,gameOver=!1,score={ties:0,player:0,computer:0},xText='<span class="x">&times;</class>',oText='<span class="o">o</class>',playerText=xText,computerText=oText,difficulty=1,myGrid=null;function Grid(){this.cells=new Array(9)}function initialize(){myGrid=new Grid,gameOver=!1,whoseTurn=player;for(var e=winner=moves=0;e<=myGrid.cells.length-1;e++)myGrid.cells[e]=0;setTimeout(showOptions,500)}function assignRoles(){askUser("Do you want to go first?"),document.getElementById("yesBtn").addEventListener("click",makePlayerX),document.getElementById("noBtn").addEventListener("click",makePlayerO)}function makePlayerX(){computer=o,whoseTurn=player=x,playerText=xText,computerText=oText,document.getElementById("userFeedback").style.display="none",document.getElementById("yesBtn").removeEventListener("click",makePlayerX),document.getElementById("noBtn").removeEventListener("click",makePlayerO)}function makePlayerO(){player=o,whoseTurn=computer=x,playerText=oText,computerText=xText,setTimeout(makeComputerMove,400),document.getElementById("userFeedback").style.display="none",document.getElementById("yesBtn").removeEventListener("click",makePlayerX),document.getElementById("noBtn").removeEventListener("click",makePlayerO)}function cellClicked(e){var t=e.toString(),r=parseInt(t[t.length-1]);if(0<myGrid.cells[r]||whoseTurn!==player||gameOver)return!1;moves+=1,document.getElementById(e).innerHTML=playerText;var n=Math.random();return n<.3?document.getElementById(e).style.transform="rotate(180deg)":.6<n&&(document.getElementById(e).style.transform="rotate(90deg)"),document.getElementById(e).style.cursor="default",myGrid.cells[r]=player,5<=moves&&(winner=checkWin()),0===winner&&(whoseTurn=computer,makeComputerMove()),!0}function restartGame(e){if(0<moves&&!1===confirm("Are you sure you want to start over?"))return;gameOver=!1,winner=moves=0,whoseTurn=x,myGrid.reset();for(var t=0;t<=8;t++){var r="cell"+t.toString();document.getElementById(r).innerHTML="",document.getElementById(r).style.cursor="pointer",document.getElementById(r).classList.remove("win-color")}!0===e?setTimeout(showOptions,200):whoseTurn==computer&&setTimeout(makeComputerMove,800)}function makeComputerMove(){if(gameOver)return!1;var e=-1,t=[],r=[0,2,6,8];3<=moves?(!1===(e=myGrid.getFirstWithTwoInARow(computer))&&(e=myGrid.getFirstWithTwoInARow(player)),!1===e&&(e=0===myGrid.cells[4]&&1==difficulty?4:(t=myGrid.getFreeCellIndices())[intRandom(0,t.length-1)]),3==moves&&myGrid.cells[4]==computer&&player==x&&1==difficulty?myGrid.cells[7]!=player||myGrid.cells[0]!=player&&myGrid.cells[2]!=player?myGrid.cells[5]!=player||myGrid.cells[0]!=player&&myGrid.cells[6]!=player?myGrid.cells[3]!=player||myGrid.cells[2]!=player&&myGrid.cells[8]!=player?myGrid.cells[1]!=player||myGrid.cells[6]!=player&&myGrid.cells[8]!=player||(e=(t=[0,2])[intRandom(0,1)]):e=(t=[0,6])[intRandom(0,1)]:e=(t=[2,8])[intRandom(0,1)]:e=(t=[6,8])[intRandom(0,1)]:3==moves&&myGrid.cells[4]==player&&player==x&&1==difficulty&&(myGrid.cells[2]==player&&myGrid.cells[6]==computer?e=8:myGrid.cells[0]==player&&myGrid.cells[8]==computer?e=6:myGrid.cells[8]==player&&myGrid.cells[0]==computer?e=2:myGrid.cells[6]==player&&myGrid.cells[2]==computer&&(e=0))):1===moves&&myGrid.cells[4]==player&&1==difficulty?e=r[intRandom(0,3)]:2===moves&&myGrid.cells[4]==player&&computer==x&&1==difficulty?myGrid.cells[0]==computer?e=8:myGrid.cells[2]==computer?e=6:myGrid.cells[6]==computer?e=2:myGrid.cells[8]==computer&&(e=0):e=0===moves&&intRandom(1,10)<8?r[intRandom(0,3)]:0===myGrid.cells[4]&&1==difficulty?4:(t=myGrid.getFreeCellIndices())[intRandom(0,t.length-1)];var n="cell"+e.toString();document.getElementById(n).innerHTML=computerText,document.getElementById(n).style.cursor="default";var o=Math.random();o<.3?document.getElementById(n).style.transform="rotate(180deg)":.6<o&&(document.getElementById(n).style.transform="rotate(90deg)"),myGrid.cells[e]=computer,5<=(moves+=1)&&(winner=checkWin()),0!==winner||gameOver||(whoseTurn=player)}function checkWin(){for(var e=winner=0;e<=2;e++){var t=myGrid.getRowValues(e);if(0<t[0]&&t[0]==t[1]&&t[0]==t[2]){winner=t[0]==computer?(score.computer++,computer):(score.player++,player);for(var r=myGrid.getRowIndices(e),n=0;n<r.length;n++){var o="cell"+r[n];document.getElementById(o).classList.add("win-color")}return setTimeout(endGame,1e3,winner),winner}}for(i=0;i<=2;i++){var l=myGrid.getColumnValues(i);if(0<l[0]&&l[0]==l[1]&&l[0]==l[2]){winner=l[0]==computer?(score.computer++,computer):(score.player++,player);for(var s=myGrid.getColumnIndices(i),c=0;c<s.length;c++){var m="cell"+s[c];document.getElementById(m).classList.add("win-color")}return setTimeout(endGame,1e3,winner),winner}}for(i=0;i<=1;i++){var a=myGrid.getDiagValues(i);if(0<a[0]&&a[0]==a[1]&&a[0]==a[2]){winner=a[0]==computer?(score.computer++,computer):(score.player++,player);for(var d=myGrid.getDiagIndices(i),u=0;u<d.length;u++){var y="cell"+d[u];document.getElementById(y).classList.add("win-color")}return setTimeout(endGame,1e3,winner),winner}}return 0===myGrid.getFreeCellIndices().length&&(winner=10,score.ties++,endGame(winner)),winner}function announceWinner(e){document.getElementById("winText").innerHTML=e,document.getElementById("winAnnounce").style.display="block",setTimeout(closeModal,1400,"winAnnounce")}function askUser(e){document.getElementById("questionText").innerHTML=e,document.getElementById("userFeedback").style.display="block"}function showOptions(){player==o?(document.getElementById("rx").checked=!1,document.getElementById("ro").checked=!0):player==x&&(document.getElementById("rx").checked=!0,document.getElementById("ro").checked=!1),0===difficulty?(document.getElementById("r0").checked=!0,document.getElementById("r1").checked=!1):(document.getElementById("r0").checked=!1,document.getElementById("r1").checked=!0),document.getElementById("optionsDlg").style.display="block"}function getOptions(){for(var e=document.getElementsByName("difficulty"),t=0;t<e.length;t++)if(e[t].checked){difficulty=parseInt(e[t].value);break}!0===document.getElementById("rx").checked?(computer=o,whoseTurn=player=x,playerText=xText,computerText=oText):(player=o,whoseTurn=computer=x,playerText=oText,computerText=xText,setTimeout(makeComputerMove,400)),document.getElementById("optionsDlg").style.display="none"}function closeModal(e){document.getElementById(e).style.display="none"}function endGame(e){announceWinner(e==player?"Congratulations, you won!":e==computer?"Computer wins!":"It's a tie!"),gameOver=!0,winner=moves=whoseTurn=0,document.getElementById("computer_score").innerHTML=score.computer,document.getElementById("tie_score").innerHTML=score.ties,document.getElementById("player_score").innerHTML=score.player;for(var t=0;t<=8;t++){var r="cell"+t.toString();document.getElementById(r).style.cursor="default"}setTimeout(restartGame,800)}Grid.prototype.getFreeCellIndices=function(){var e=0,t=[];for(e=0;e<this.cells.length;e++)0===this.cells[e]&&t.push(e);return t},Grid.prototype.getRowValues=function(e){if(0===e||1===e||2===e){var t=3*e;return this.cells.slice(t,3+t)}console.error("Wrong arg for getRowValues!")},Grid.prototype.getRowIndices=function(e){if(0===e||1===e||2===e){var t=[];return e*=3,t.push(e),t.push(e+1),t.push(e+2),t}console.error("Wrong arg for getRowIndices!")},Grid.prototype.getColumnValues=function(e){if(0===e||1===e||2===e){var t,r=[];for(t=e;t<this.cells.length;t+=3)r.push(this.cells[t]);return r}console.error("Wrong arg for getColumnValues!")},Grid.prototype.getColumnIndices=function(e){if(0===e||1===e||2===e){var t,r=[];for(t=e;t<this.cells.length;t+=3)r.push(t);return r}console.error("Wrong arg for getColumnIndices!")},Grid.prototype.getDiagValues=function(e){var t=[];if(1===e||0===e)return 0===e?(t.push(this.cells[0]),t.push(this.cells[4]),t.push(this.cells[8])):(t.push(this.cells[2]),t.push(this.cells[4]),t.push(this.cells[6])),t;console.error("Wrong arg for getDiagValues!")},Grid.prototype.getDiagIndices=function(e){return 1!==e&&0!==e?void console.error("Wrong arg for getDiagIndices!"):0===e?[0,4,8]:[2,4,6]},Grid.prototype.getFirstWithTwoInARow=function(e){if(e===computer||e===player){for(var t=2*e,r=shuffleArray(this.getFreeCellIndices()),n=0;n<r.length;n++){for(var o=0;o<3;o++){var l=this.getRowValues(o),i=this.getRowIndices(o),s=this.getColumnValues(o),c=this.getColumnIndices(o);if(sumArray(l)==t&&isInArray(r[n],i))return r[n];if(sumArray(s)==t&&isInArray(r[n],c))return r[n]}for(j=0;j<2;j++){var m=this.getDiagValues(j),a=this.getDiagIndices(j);if(sumArray(m)==t&&isInArray(r[n],a))return r[n]}}return!1}console.error("Function getFirstWithTwoInARow accepts only player or computer as argument.")},Grid.prototype.reset=function(){for(var e=0;e<this.cells.length;e++)this.cells[e]=0;return!0};
//# sourceMappingURL=Tic-Tac-Toe.min.js.map
